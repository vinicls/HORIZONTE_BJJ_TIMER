/* ===== Tokens base ===== */
:root{
  --bg:#070a10; --panel:#0c111b; --accent:#22d3ee; --accent-2:#a78bfa;
  --muted:#9aa5b1; --text:#e6edf3; --danger:#ef4444; --glow: 0 0 40px rgba(34,211,238,.15);
  --final-bg:#2a0b0b;
  --c-round:#22c55e; --c-prep:#f59e0b; --c-paused:#eab308; --c-final:#ef4444;
  --c-rest:#9aa5b1; --c-rest-warn:#facc15; --success:#22c55e;

  --btn-w: clamp(148px, 20vw, 180px); /* Ajustado para caber sem rolagem */
  --btn-h: clamp(48px, 6.2vh, 68px);
  --select-font: clamp(18px, 2.5vw, 22px);
  --select-pad: clamp(10px, 1.5vw, 12px);
  --select-h: calc(var(--select-font) + (var(--select-pad) * 2) + 6px);
  --select-w: clamp(120px, 18vw, 160px); /* Ajustado para caber sem rolagem */

  /* Display base */
  --display-font: clamp(96px, 27vw, 324px);
  --display-h: clamp(126px, 25.2vw, 342px);

  /* Foco PC/TV */
  --focusPC-display-w: clamp(700px, 65vw, 1200px); /* Reduzido para evitar overflow */
  --focusPC-display-h: clamp(200px, 32vw, 400px);
  --focusPC-font: clamp(160px, 28vw, 400px);

  /* Foco Mobile/Tablet */
  --focusMB-display-w: min(92vw, 720px);
  --focusMB-display-h: clamp(160px, 28vh, 260px);
  --focusMB-font: clamp(100px, 20vw, 220px);
}
:root[data-theme="classico"]{ --bg:#0b0f14; --panel:#121823; --accent:#2dd4bf; --accent-2:#60a5fa; --muted:#9aa5b1; --text:#e6edf3; --danger:#ef4444; --glow: 0 0 40px rgba(45,212,191,.12); --final-bg:#2a0b0b; }
:root[data-theme="claro"]{
  --bg:#f6f7fb; --panel:#ffffff; --accent:#0ea5e9; --accent-2:#8b5cf6;
  --muted:#344055; --text:#0b1220; --danger:#b91c1c; --glow: 0 0 20px rgba(14,165,233,.12);
  --final-bg:#fde7e7;
}

/* ===== Reset e base ===== */
*{ box-sizing:border-box; }
html, body{
  height:100%;
  margin:0; padding:0;
  overflow-x:hidden;
  max-width:100%;
  color:var(--text);
  background:
    radial-gradient(1600px 900px at 70% 0%, rgba(34,211,238,.08), transparent 40%),
    radial-gradient(1200px 800px at 20% 100%, rgba(167,139,250,.06), transparent 50%),
    var(--bg);
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial,'Noto Sans',sans-serif;
}

/* ===== Splash ===== */
#splash{
  position:fixed; inset:0; z-index:9999;
  background: radial-gradient(1600px 900px at 70% 0%, rgba(34,211,238,.12), transparent 40%),
              radial-gradient(1200px 800px at 20% 100%, rgba(167,139,250,.10), transparent 50%),
              #070a10;
  display:flex; align-items:center; justify-content:center;
  pointer-events:auto; touch-action:none; overscroll-behavior:contain;
  will-change: opacity, visibility;
  transition: opacity 0.4s ease, visibility 0.4s ease;
}
#splash.hidden{
  opacity:0;
  visibility:hidden;
  pointer-events:none;
  display:none;
}
.splash-logo{
  width:min(50vw, 520px);
  filter: drop-shadow(0 0 10px rgba(255,255,255,.55)) drop-shadow(0 0 4px rgba(255,255,255,.45));
}

/* Esconder main inicialmente */
.hidden-main{
  display:none;
}

/* ===== Layout geral ===== */
.container{
  min-height:100svh;
  display:flex; flex-direction:column;
  gap:2.2vh;
  padding:2.5vh 2.5vw;
  padding-top: calc(2.5vh + env(safe-area-inset-top, 0px));
  padding-bottom: calc(2.5vh + env(safe-area-inset-bottom, 0px));
}

/* ===== Topbar ===== */
.topbar{ display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:16px; }
.brand{ margin:0; font-size:clamp(18px,3.2vw,30px); font-weight:900; letter-spacing:.06em; text-transform: uppercase; justify-self:center; text-align:center; }
.datetime{ display:flex; flex-direction:column; gap:2px; font-variant-numeric: tabular-nums; justify-self:start; }
#dateText{ font-size:clamp(22px,3.5vw,28px); color:var(--muted); font-weight:700; }
#timeText{ font-size:clamp(30px,5vw,40px); font-weight:900; letter-spacing:.02em; }
.right-side{ justify-self:end; }
.top-controls{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
.inline{ display:flex; align-items:center; gap:8px; color:var(--muted); font-weight:700; }
.top-controls select{ background:#0e1420; color:#fff; border:1px solid rgba(255,255,255,.18); border-radius:10px; padding:8px 10px; font-weight:700; max-width:40vw; }
:root[data-theme="claro"] .top-controls select{ background:#f1f5f9; color:#0b1220; border-color:#cbd5e1; }

/* Desktop: Seletores sons/temas lado a lado */
@media (min-width: 1025px) {
  .top-controls { display: flex; flex-direction: row; gap: 12px; align-items: center; }
  .top-controls .inline { flex: 0 1 auto; min-width: 150px; max-width: 200px; }
}

/* ===== Card ===== */
.timer-section{
  position:relative; background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.05));
  border:1px solid rgba(255,255,255,.06); border-radius:26px; padding:3.2vh 3vw;
  display:flex; flex-direction:column; align-items:center; gap:2.2vh;
  box-shadow: 0 16px 40px rgba(0,0,0,.35), var(--glow); overflow:hidden; min-height: 64vh;
}
:root[data-theme="claro"] .timer-section{ background:#ffffff; border-color:#e2e8f0; box-shadow: 0 8px 24px rgba(2,6,23,.06); }

/* ===== Status ===== */
.status-panel{ font-size: clamp(18px, 3.2vw, 36px); font-weight: 900; letter-spacing:.02em; text-transform: uppercase; }

/* ===== Display + Logo lateral ===== */
.display-wrap{
  width:100%;
  display:grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items:center;
  gap:min(6vw, 40px);
}
.display{
  font-size: var(--display-font);
  font-weight: 900;
  letter-spacing: .04em;
  line-height:1;
  padding: 14px 22px;
  border-radius: 22px;
  background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.08));
  border: 1px solid rgba(255,255,255,.06);
  font-variant-numeric: tabular-nums;
  text-shadow: 0 2px 0 rgba(0,0,0,.35);
  box-shadow: inset 0 -10px 22px rgba(0,0,0,.22);
  min-height: var(--display-h);
  display:flex; align-items:center; justify-content:center; text-align:center; min-width:0;
}
.display.final-warning{ background: linear-gradient(180deg, rgba(255,0,0,.18), rgba(0,0,0,.08)); border-color: rgba(255,0,0,.32); }
.flash-red{ animation: flashRed .65s steps(2, jump-none) infinite; }
@keyframes flashRed{ 0%,100%{ color:#ffffff; background:linear-gradient(180deg, rgba(255,0,0,.28), var(--final-bg)); } 50%{ color:#ffdddd; background:linear-gradient(180deg, rgba(255,0,0,.06), rgba(0,0,0,.08)); } }

/* Preparação (piscar laranja) */
.display.prep-warning{ background: linear-gradient(180deg, rgba(245,158,11,.16), rgba(0,0,0,.06)); border-color: rgba(245,158,11,.32); color: var(--c-prep) !important; }
.flash-prep{ animation: flashPrep .65s steps(2, jump-none) infinite; }
@keyframes flashPrep{ 0%,100%{ color: var(--c-prep); } 50%{ color: #ffffff; } }

/* Descanso (cinza) e aviso âmbar 10s finais */
.display.rest-mode{ color: var(--c-rest); }
.display.rest-warning{ background: linear-gradient(180deg, rgba(250,204,21,.16), rgba(0,0,0,.06)); border-color: rgba(250,204,21,.32); color: var(--c-rest-warn) !important; }
.flash-amber{ animation: flashAmber .65s steps(2, jump-none) infinite; }
@keyframes flashAmber{ 0%,100%{ color: var(--c-rest-warn); } 50%{ color: #ffffff; } }

/* Logos */
.logo-mark.side{
  width: clamp(120px, 16vw, 260px); max-width: 30vw; height: auto; object-fit: contain;
  filter: drop-shadow(0 0 6px rgba(255,255,255,.45)) drop-shadow(0 0 2px rgba(255,255,255,.35));
  opacity:.98; pointer-events:none;
}
.logo-top, .logo-bottom{
  display:none; margin:0 auto; width: clamp(120px, 25vw, 180px);
  filter: drop-shadow(0 0 10px rgba(255,255,255,.55)) drop-shadow(0 0 4px rgba(255,255,255,.45));
}
.desktop-only{ display:block; }
.mobile-only{ display:none; }

/* ===== Form ===== */
.set-form{ display:flex; flex-direction: row; flex-wrap: wrap; gap:18px; align-items:end; justify-content:center; max-width: 100%; }
.set-form label{ display:flex; flex-direction:column; gap:8px; text-transform: uppercase; font-weight: 900; color:var(--muted); }
.set-form select, .set-form input[type="file"]{
  width: var(--select-w);
  padding: var(--select-pad) calc(14px * 1.3);
  border-radius:12px; border:1px solid rgba(255,255,255,.12);
  background:#0e1420; color:var(--text); font-size: var(--select-font);
  outline:none; font-weight:800; max-width:100%;
}
:root[data-theme="claro"] .set-form select, :root[data-theme="claro"] .set-form input[type="file"]{ background:#f1f5f9; color:#0b1220; border-color:#cbd5e1; }
.set-form select:focus, .set-form input[type="file"]:focus{ border-color:var(--accent); box-shadow:0 0 0 3px rgba(34,211,238,.15); }

/* Presets lado a lado */
.presets-row{ display:flex; flex-direction: row; gap:14px; flex-wrap:wrap; justify-content:center; width:100%; margin-top:10px; }

/* Botões */
.controls{ display:flex; gap:14px; flex-wrap:wrap; justify-content:center; }
.btn{
  width: var(--btn-w); height: var(--btn-h);
  display:inline-flex; align-items:center; justify-content:center;
  padding: 0 18px; border-radius:14px; border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg, #0f172a, #0b1320); color:#ffffff;
  cursor:pointer; transition: transform .06s ease, box-shadow .18s ease, background .2s;
  text-transform: uppercase; font-weight: 900; letter-spacing:.03em; white-space: nowrap;
}
.btn:hover{ transform: translateY(-1px); }
.btn:active{ transform: translateY(0); }
.btn.primary{ border-color: rgba(34,211,238,.65); box-shadow: 0 0 0 3px rgba(34,211,238,.12) inset; }
.btn.danger{ border-color: rgba(239,68,68,.65); background: linear-gradient(180deg, #3b0f0f, #2a0b0b); }
.btn-define{ border-color: rgba(34,197,94,.65); background: linear-gradient(180deg, #0b2a16, #0a1f12); color:#dcfce7; }
.btn-define:hover{ box-shadow: 0 0 0 3px rgba(34,197,94,.12) inset; }
.btn-lg{ font-size: clamp(14px, 2.2vw, 18px); }
.btn[disabled], .set-form select[disabled]{ opacity:.5; cursor:not-allowed; }

/* DEFINIR do tamanho dos selects */
.btn-define-like-select{ width: var(--select-w) !important; min-height: var(--select-h) !important; }

/* Tema claro — contraste forte nos botões */
:root[data-theme="claro"] .btn{ background: linear-gradient(180deg, #0b1526, #0a1220); color: #ffffff; border-color: rgba(15,23,42,.35); }

/* ===== Responsividade ===== */
@media (max-width: 1024px) {
  .datetime{ display:none; }
  .mobile-only{ display:block; }
  .desktop-only{ display:none; }
  .brand{ font-size: clamp(20px, 5vw, 28px); text-align:center; margin:auto; }
  .line1, .line2{ display:block; }
  .mobile-break{ display:block; }
  .display{ font-size: var(--display-font); padding: 10px 14px; letter-spacing: .02em; }
  .logo-top, .logo-bottom{ display:block; }
  .controls{ flex-direction: column; align-items: center; gap: 12px; }
  .btn-fixed{ width: min(90vw, 300px); }
  .top-controls{ display:none; }
  .mobile-bottom-selects{ display:flex; justify-content:center; flex-wrap:wrap; gap:12px; }
  .mobile-bottom-selects select{ width: 45vw; max-width: 220px; }
}

/* TV */
body[data-device="tv"] .container{ padding:5vh 5vw; }
body[data-device="tv"] .display{ letter-spacing:.06em; }

/* Descanso cinza como regra final */
body[data-state="rest"] .display{ color:var(--c-rest); }

/* ===== MODO FOCO ===== */
body.focus{
  overflow-x:hidden;
  overflow-y:auto;
  display:flex; flex-direction:column; align-items:center;
}
body.focus #setForm,
body.focus .top-controls,
body.focus .mobile-bottom-selects,
body.focus #appTitle,
body.focus #logoTop,
body.focus #resetBtn,
body.focus #soundTestBtn { display:none !important; }

/* Status visível no modo foco, acima do display */
body.focus #statusPanel{ display:block !important; margin-bottom: 10px; }

/* Foco: só HORA visível (sem data) em PC/TV */
body.focus .datetime{ display:flex !important; }
body.focus #dateText{ display:none !important; }
@media (max-width: 1024px){
  body.focus .datetime{ display:none !important; }
}

/* Foco PC/TV: status + display + controles/logo */
body.focus #displayWrap{
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}
body.focus #countdownDisplay{
  width: var(--focusPC-display-w);
  height: var(--focusPC-display-h);
  min-width: var(--focusPC-display-w);
  min-height: var(--focusPC-display-h);
  max-width: var(--focusPC-display-w);
  max-height: var(--focusPC-display-h);
  font-size: var(--focusPC-font);
  margin: 0 auto;
}
body.focus #controls{
  display: grid;
  grid-template-columns: auto auto auto; /* Botões + logo */
  align-items: center;
  gap: 14px;
  margin-top: 10px;
}
body.focus #logoMain{
  display: block !important;
  width: clamp(100px, 12vw, 200px); /* Logo menor */
  margin: 0;
  grid-column: 3 / 4; /* À direita dos botões */
}

/* Foco MOBILE/TABLET: status + display + logo abaixo */
@media (max-width: 1024px){
  body.focus #displayWrap{
    flex-direction: column;
    align-items: center;
  }
  body.focus #countdownDisplay{
    width: var(--focusMB-display-w);
    height: var(--focusMB-display-h);
    min-width: var(--focusMB-display-w);
    min-height: var(--focusMB-display-h);
    max-width: var(--focusMB-display-w);
    max-height: var(--focusMB-display-h);
    font-size: var(--focusMB-font);
  }
  body.focus #controls{
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  body.focus #logoMain{ display:none !important; }
  body.focus #logoBottom{ display:block !important; margin-top: 10px; }
  body.focus .btn{ width: min(80vw, 320px); }
}